<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manage Chatroom - WhatsApp SN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body class="bg-dark text-light d-flex flex-column min-vh-100">

<nav th:replace="~{fragments/navbar.html :: navbar}"> </nav>

<div class="container my-5">

    <div class="mb-4 d-flex flex-column flex-md-row gap-2">
        <a th:href="@{/chatrooms/{id}/view-chatroom(id=${chatroom.id})}" class="btn btn-outline-light">Back</a>

        <a th:href="@{/chatrooms/{id}/leave-confirm(id=${chatroomId})}" class="btn btn-outline-danger">Leave Chatroom</a>
    </div>

    <div class="bg-secondary-subtle rounded p-4 text-dark shadow-sm mb-4">
        <h2 class="mb-3">Chatroom Settings</h2>

        <!-- Editable group name (if enabled) -->
        <div th:if="${chatroom.type == T(com.app.model.ChatroomType).GROUP and chatroom.editableName}">
            <form th:action="@{/chatrooms/{id}/edit(id=${chatroom.id})}" method="post" class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="name" class="col-form-label">Edit Group Name</label>
                </div>
                <div class="col-auto">
                    <input type="text" id="name" name="name" th:value="${chatroom.name}" required class="form-control" />
                </div>
                <div class="col-auto">
                    <button type="submit" class="btn btn-primary btn-sm">Save</button>
                </div>
            </form>
        </div>

        <!-- Static name (if not editable) -->
        <h4 th:if="${!(chatroom.type == T(com.app.model.ChatroomType).GROUP and chatroom.editableName)}"
            th:text="${chatroom.name}"
            class="mt-3"></h4>
    </div>

    <div th:replace="~{fragments/chatroom/chatroom-managment :: chatroomManagment(${chatroomType}, ${chatroomId}, ${editNameMode})}"></div>
</div>

<footer th:replace="~{fragments/footer.html :: footer}"> </footer>
<div th:insert="fragments/scripts.html :: bootstrapScript"></div>

</body>
</html>
